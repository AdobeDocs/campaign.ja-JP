---
solution: Campaign v8
product: Adobe Campaign
title: データモデルのベストプラクティス
description: Campaignデータモデル拡張機能のベストプラクティスについて説明します。
source-git-commit: 4ae0c968bd68d76d7ceffb91023d5426d6a810ea
workflow-type: tm+mt
source-wordcount: '2684'
ht-degree: 4%

---

# データモデルのベストプラクティス{#data-model-best-practices}

このドキュメントでは、Adobe Campaignデータモデルを設計する際の主な推奨事項の概要を説明します。

Adobe Campaignシステムは非常に柔軟で、最初の実装を超えて拡張できます。 ただし、可能性は無限ですが、賢明な決定を下し、強力な基盤を構築してデータモデルの設計を開始することが重要です。

Campaignの組み込みテーブルとそれらの関係について詳しくは、 [この節](datamodel.md)を参照してください。

[!DNL :bulb:] Campaignスキーマの [概要に](schemas.md) ついては、この節を参照してください。

[!DNL :bulb:] Adobe Campaignデータベースの概念的データモデルを拡張するための拡張スキーマの設定方法については、このページ [を参照してください](extend-schema.md)。

## データモデルアーキテクチャ{#data-model-architecture}

Adobe Campaignは、オンラインとオフラインの戦略を融合し、パーソナライズされた顧客体験を創出するのに役立つ、強力なクロスチャネルキャンペーン管理システムです。

### 顧客中心アプローチ{#customer-centric-approach}

ほとんどの電子メールサービスプロバイダーはリスト中心のアプローチを通じて顧客と通信しますが、Adobe Campaignは、顧客とその属性に関するより広い視野を活用するためにリレーショナルデータベースに依存しています。

各テーブルの説明にアクセスするには、**[!UICONTROL 管理者/設定/データスキーマ]**&#x200B;に移動し、リストからリソースを選択して、「**[!UICONTROL ドキュメント]**」タブをクリックします。


>[!NOTE]
>
>Adobe Campaignでは、[カスタム受信者テーブル](custom-recipient.md)を作成できます。 ただし、ほとんどの場合は、組み込みの[受信者テーブル](datamodel.md#ootb-profiles)を利用することをお勧めします。受信者テーブルには、事前に組み込まれている追加のテーブルや機能があります。

### Adobe Campaign {#data-for-campaign}のデータ

Adobe Campaignに送信するデータの種類 マーケティング活動に必要なデータを決定することが重要です。

>[!NOTE]
>
>Adobe Campaignは、Data Warehouseでもレポートツールでもありません。 したがって、考えられるすべての顧客とその関連情報をAdobe Campaignにインポートしたり、レポートの作成にのみ使用されるデータをインポートしたりしないでください。

属性がAdobe Campaignで必要かどうかを判断するには、次のいずれかに該当するかどうかを自問します。

* **セグメント化**&#x200B;に使用する属性
* **データ管理プロセス**&#x200B;に使用される属性（集計計算など）
* **パーソナライゼーション**&#x200B;に使用する属性

これらのいずれかに該当しない場合、Adobe Campaignではこの属性は必要ない可能性が高くなります。

### データ型の選択{#data-types}

システムのアーキテクチャとパフォーマンスを良好に保つために、以下のベストプラクティスに従ってAdobe Campaignでデータを設定します。

* 大きなテーブル内では、文字列フィールドまたは数値フィールドを挿入し、参照テーブルにリンクを追加できます（値のリストを操作する場合）。
* **expr**&#x200B;属性を使用すると、スキーマ属性を、テーブル内の物理的な設定値ではなく、計算フィールドとして定義できます。 これにより、両方の値を保存する必要なく、異なる形式（年齢や生年月日など）で情報にアクセスできます。 これは、フィールドの重複を避ける良い方法です。 例えば、受信者テーブルでは、Eメールフィールドに既に存在するドメインに対して式を使用します。
* ただし、式の計算が複雑な場合は、**expr**&#x200B;属性を使用しないことをお勧めします。クエリのパフォーマンスに影響を与える可能性があるためです。
* フィールドの数が多すぎるのを防ぐには、**XML**&#x200B;タイプを使用するとよいでしょう。 しかし、データベース内のCLOB列を使用するので、ディスク領域も占有されます。 また、複雑なSQLクエリが発生し、パフォーマンスに影響を与える可能性もあります。
* **文字列**&#x200B;フィールドの長さは、常に列で定義する必要があります。 デフォルトでは、Adobe Campaignの最大長は16Kですが、サイズが短くならないことが既にわかっている場合は、Adobeでフィールドを短く保つことをお勧めします。
* ソース・システムのサイズが過大評価されていて、その値に達しないことが確実な場合は、Adobe Campaignのフィールドの値をソース・システムの値よりも短くすることが許容されます。 Adobe Campaignでは、文字列が短いか小さい整数を意味する可能性があります。

### フィールドの選択{#choice-of-fields}

ターゲティングまたはパーソナライゼーションの目的を持つフィールドは、テーブルに格納する必要があります。 つまり、パーソナライズされたEメールの送信にフィールドを使用したり、クエリの条件として使用したりしない場合、不必要にディスク領域が占有されます。


### キーの選択{#choice-of-keys}

ほとんどのテーブルでデフォルトで定義されている&#x200B;**autouid**&#x200B;に加えて、論理キーまたはビジネスキー（アカウント番号、クライアント番号など）を追加することを検討する必要があります。 後でインポート/紐付けやデータパッケージに使用できます。 詳しくは、[識別子](#identifiers)を参照してください。

効率的なキーは、パフォーマンスに不可欠です。 Snowflakeを使用すると、数値または文字列ベースのデータ型をテーブルのキーとして挿入できます。

<!-- ### Dedicated tablespaces {#dedicated-tablespaces}

The tablespace attribute in the schema allows you to specify a dedicated tablespace for a table.

The installation wizard allows you to store objects by type (data, temporary).

Dedicated tablespaces are better for partitioning, security rules, and allow fluid and flexible administration, better optimization, and performance. -->

## 識別子 {#identifiers}

Adobe Campaignリソースには3つの識別子があり、識別子を追加できます。

次の表に、これらの識別子とその目的を示します。

| 識別子 | 説明 | ベストプラクティス |
|--- |--- |--- |
| ID | <ul><li>IDは、Adobe Campaignテーブルの物理的なプライマリキーです。 組み込みテーブルの場合、これはユニバーサル固有ID(UUID)です</li><li>この識別子は一意である必要があります。 </li><li>UUIDは、スキーマ定義で表示できます。</li></ul> | <ul><li>自動生成された識別子は、ワークフローやパッケージ定義で参照として使用しないでください。</li><li>テーブルのIDはUUIDで、このタイプは変更しないでください。</li></ul> |
| 名前（または内部名） | <ul><li>この情報は、テーブル内のレコードの一意の識別子です。 この値は手動で更新でき、通常は生成された名前を使用します。</li><li>この識別子は、Adobe Campaignの別のインスタンスにデプロイされる際に値を保持し、空にしないでください。</li></ul> | <ul><li>オブジェクトを環境から別の環境にデプロイする場合に、Adobe Campaignで生成されたレコード名を変更します。</li><li>オブジェクトに名前空間属性（*schema*&#x200B;など）がある場合、この共通の名前空間は作成されるすべてのカスタムオブジェクトで利用されます。 一部の予約済み名前空間は使用しないでください。*nms*、*xtk*&#x200B;など。  一部の名前空間は内部のみであることに注意してください。 [詳細情報](schemas.md#reserved-namespaces)。</li><li>オブジェクトに名前空間（*workflow*&#x200B;や&#x200B;*delivery*&#x200B;など）がない場合、この名前空間概念は内部名オブジェクトのプレフィックスとして追加されます。*namespaceMyObjectName*&#x200B;とします。</li><li>スペース「 」、セミコラム「:」、ハイフン「 — 」などの特殊文字は使用しないでください。 これらの文字はすべて、アンダースコア「_」（許可された文字）に置き換えられます。 例えば、「abc-def」と「abc:def」は「abc_def」として保存され、互いに上書きされます。</li></ul> |
| ラベル | <ul><li>ラベルは、Adobe Campaignのオブジェクトまたはレコードのビジネス識別子です。</li><li>このオブジェクトでは、スペースと特殊文字を使用できます。</li><li>レコードの一意性は保証されません。</li></ul> | <ul><li>オブジェクトラベルの構造を決定することをお勧めします。</li><li>これは、Adobe Campaignユーザーのレコードやオブジェクトを識別する、最も使いやすいソリューションです。</li></ul> |

Adobe Campaignのプライマリキーは、すべての組み込みテーブルの自動生成UUIDです。 UUIDは、カスタムテーブルにも使用できます。

IDの数が無制限であっても、最適なパフォーマンスを確保するために、データベースのサイズを慎重におこなう必要があります。 問題を回避するには、必ずインスタンスのパージ設定を調整してください。 詳しくは、[この節](#data-retention)を参照してください。


## カスタム内部キー{#custom-internal-keys}

プライマリキーは、Adobe Campaignで作成されるすべてのテーブルに必要です。

ほとんどの組織は、外部システムからレコードをインポートしています。 受信者テーブルの物理キーは「id」属性ですが、カスタムキーも特定できます。

このカスタムキーは、外部システムフィードAdobe Campaignの実際のレコードのプライマリキーです。

カスタムテーブルを作成する場合、次の2つのオプションがあります。
* 自動生成されたキー(ID)と内部キー（カスタム）の組み合わせ。 このオプションは、システムキーが複合キーであるか整数でない場合に興味深い。 Snowflakeを使用すると、整数または文字列ベースのキーは、大きなテーブルでパフォーマンスが向上し、他のテーブルとの結合が可能になります。
* プライマリキーを外部システムのプライマリキーとして使用する。 異なるシステム間で一貫したキーを持つデータのインポートとエクスポートのアプローチを簡素化するので、このソリューションを通常お勧めします。 キーの名前が「id」で、（自動生成ではなく）外部値が入力されると想定される場合は、Autouuidを無効にする必要があります。

>[!CAUTION]
>
>autouidは、ワークフローの参照として使用しないでください。


## リンクと基数{#links-and-cardinality}

### リンク {#links}

大きなテーブルの「own」整合性に注意してください。 整合性が「own」の大きなテーブルを持つレコードを削除すると、インスタンスが停止する可能性があります。 テーブルはロックされ、削除は1つずつ行われます。 したがって、ボリュームの大きい子テーブルには「neutral」整合性を使用することをお勧めします。

リンクを外部結合として宣言するのは、パフォーマンスには適していません。 ゼロIDレコードは、外部結合機能をエミュレートします。 リンクでautouuidが使用されている場合、外部結合を宣言する必要はありません。

ワークフロー内の任意のテーブルを結合できますが、Adobeでは、データ構造の定義でリソース間の共通リンクを直接定義することをお勧めします。

リンクは、テーブル内の実際のデータに合わせて定義する必要があります。 誤った定義は、予期せずレコードを複製するなど、リンク経由で取得されたデータに影響を与える可能性があります。

テーブル名に一貫したリンク名を付ける：リンク名は、距離テーブルの内容を理解するのに役立ちます。

サフィックスに「id」を含むリンクの名前を付けないでください。 例えば、「transactionId」ではなく「transaction」という名前を付けます。

デフォルトでは、Adobe Campaignは外部テーブルのプライマリキーを使用してリンクを作成します。 より明確にするには、リンク定義で結合を明示的に定義することをお勧めします。

### カーディナリティ {#cardinality}

リンクをデザインする場合、1対1の関係が宣言されているときに、ターゲットレコードが一意であることを確認します。 そうしないと、1つしか期待されない場合に、結合が複数のレコードを返す可能性があります。 これにより、「クエリが予想より多くの行を返す」場合に、配信準備中にエラーが発生します。 リンク名をターゲットスキーマと同じ名前に設定します。

(1)側のスキーマに基数(1～N)を持つリンクを定義します。 例えば、トランザクションスキーマに受信者(1) ～ (N)トランザクションという関係を定義する必要があります。

デフォルトでは、リンクの逆基数は(N)です。 リンク定義にrevCardinality=&#39;single&#39;属性を追加することで、リンク(1-1)を定義できます。

リバースリンクがユーザーに表示されない場合は、リンク定義revLink=&#39;_NONE_&#39;を使用して非表示にできます。 例えば、受信者から最後に完了したトランザクションへのリンクを定義する場合などに役立ちます。 受信者から最後のトランザクションへのリンクのみを確認する必要があり、トランザクションテーブルから逆リンクを表示する必要はありません。

外部結合(1 ～ 0.1)を実行するリンクは、システムのパフォーマンスに影響を与えるので、慎重に使用する必要があります。

## データリテンション {#data-retention}

Adobe Campaignは、Data Warehouseでもレポートツールでもありません。 したがって、Adobe Campaignソリューションのパフォーマンスを向上させるには、データベースの増大を抑制する必要があります。 これを実現するには、以下のベストプラクティスに従うと役に立つ場合があります。

Campaign の組み込みログテーブルには保持期間がプリセットされており、通常はデータ保存期間が 6 か月以内に制限されています。

組み込みテーブルのデフォルトの保持期間は以下のとおりです。リテンションは実装時にアドビの技術管理者が設定します。値は顧客の要件に基づくため、実装ごとに異なる場合があります。

* **統合されたトラッキング**：1 年
* **配信ログ**：6 ヶ月
* **トラッキングログ**：1 年
* **削除された配信**：1 週間
* **却下をインポート**：6 か月
* **訪問者プロファイル**：1 か月
* **オファーの提案**：1 年
* **イベント**：1 ヶ月
* **イベント処理の統計**：1 か月
* **アーカイブしたイベント**：1 年
* **無視されたパイプラインイベント**：1 か月

>[!CAUTION]
>
>標準のクリーンアッププロセスでは、カスタムテーブルはパージされません。 これは1日目には必要ない場合がありますが、パフォーマンスの課題を引き起こす可能性があるので、カスタムテーブルのパージプロセスを作成するのを忘れないでください。

Adobe Campaignでのレコードの必要性を最小限に抑えるソリューションがいくつかあります。
* Adobe Campaign以外のData Warehouseにデータをエクスポートします。
* マーケティングプラクティスに十分でありながら、使用するスペースを減らす集計値を生成します。 例えば、最後の購入を追跡するために、Adobe Campaignの顧客トランザクション履歴全体を必要としない場合などです。

「deleteStatus」属性をスキーマで宣言できます。 レコードを削除済みとしてマークし、クリーンアップタスクで削除を延期する方が効率的です。

[!DNL :speech_balloon:] 管理対象Cloud Servicesのユーザーは、Adobeコンサルタントまたは技術管理者に連絡して、リテンションの詳細を確認したり、カスタムテーブルのリテンションを設定する必要がある場合は、

## パフォーマンス {#performance}

パフォーマンスを常に向上させるには、以下のベストプラクティスに従ってください。

### 一般的な推奨事項 {#general-recommendations}

* クエリで「CONTAINS」などの操作は使用しないでください。 何をフィルターするかがわかっており、必要に応じて「EQUAL TO」やその他の特定のフィルター演算子を使用して同じ条件を適用します。
* 読み込みや書き出しなどのプロセスが業務時間外に発生することを確認してください。
* すべての日々のアクティビティのスケジュールがあることを確認し、スケジュールに従います。
* 毎日の1つまたは複数のプロセスが失敗し、その日に実行する必要がある場合は、手動プロセスがキックオフされると、システムのパフォーマンスに影響を与える可能性があるので、競合するプロセスが実行されていないことを確認します。
* インポートプロセス中、または手動プロセスが実行された場合は、毎日のキャンペーンが実行されていないことを確認します。
* 各行にフィールドを複製するのではなく、1つまたは複数の参照テーブルを使用します。 キーと値のペアを使用する場合は、数値キーを選択することをお勧めします。
* 短い文字列は引き続き使用できます。 参照テーブルが外部システムに既に配置されている場合は、同じテーブルを再利用すると、Adobe Campaignとのデータ統合が容易になります。

### 1対多の関係{#one-to-many-relationships}

* データデザインは、ユーザビリティと機能に影響を与えます。 多くの1対多の関係を持つデータモデルを設計すると、ユーザーがアプリケーションで意味のあるロジックを構築するのがより難しくなります。 1対多のフィルターロジックは、技術的でないマーケターが正しく作成および理解するのが困難な場合があります。
* ユーザーがクエリを簡単に作成できるので、1つのテーブルにすべての必須フィールドを含めることをお勧めします。 また、結合を避ける場合に、パフォーマンスが複数のテーブルにまたがって一部のフィールドを複製すると良い場合もあります。
* 特定の組み込み機能では、「オファーの重み付け」の数式や「配信」など、1対多の関係を参照できません。

## 大きなテーブル{#large-tables}

Adobe Campaignは、サードパーティのデータベースエンジンに依存しています。 プロバイダーによっては、大きなテーブルのパフォーマンスを最適化する際に、特定の設計が必要になる場合があります。

大きなテーブルと複雑な結合を使用してデータモデルを設計する際に従うべき一般的なベストプラクティスをいくつか示します。

* 追加のカスタム受信者テーブルを使用する場合は、各配信マッピングに専用のログテーブルがあることを確認します。
* 特に未使用の列を識別して、列の数を減らします。
* 複数の条件や複数の列に対する結合など、複雑な結合を避け、データモデルの関係を最適化します。
* 結合キーには、数値または文字列ベースの値を使用できます。
* ログの保持の深さをできるだけ減らします。 より深い履歴が必要な場合は、計算を集計したり、カスタムログテーブルを処理して大きな履歴を保存したりできます。

### テーブルのサイズ{#size-of-tables}

テーブルサイズは、レコード数とレコードあたりの列数の組み合わせです。 どちらも、クエリのパフォーマンスに影響を与える可能性があります。

* **小さいサイズの**&#x200B;テーブルは、配信テーブルに似ています。
* **中サイズ**&#x200B;テーブルは、受信者テーブルのサイズと同じです。 顧客ごとに1件のレコードがあります。
* **大きいサイズの**テーブルは、Broadログテーブルに似ています。 1人の顧客に多くのレコードがあります。
例えば、データベースに1,000万人の受信者が含まれている場合、Broadログテーブルには約1億～2,000万のメッセージが含まれ、Deliveryテーブルには数千のレコードが含まれます。

行数はパフォーマンスにも影響します。 Adobe Campaignデータベースは、ターゲティングやパーソナライゼーションの目的で積極的に使用されない履歴データを格納するように設計されていません。これは、運用データベースです。

行数の多さに関連するパフォーマンスの問題を防ぐには、必要なレコードのみをデータベースに保持します。 その他のレコードは、サードパーティのData Warehouseにエクスポートして、Adobe Campaignの運用データベースから削除する必要があります。

テーブルのサイズに関するベストプラクティスを以下に示します。

* フィールド数が少なく、数値データが多い大きなテーブルをデザインします。
* 大きな数値タイプの列を使用して、ブール値などの小さな数値を格納しないでください。
* テーブル定義から未使用の列を削除します。
* Adobe Campaignデータベースに履歴データや非アクティブなデータを保持しないでください（書き出しとクリーンアップ）。
