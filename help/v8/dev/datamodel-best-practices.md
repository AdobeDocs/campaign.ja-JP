---
solution: Campaign
product: Adobe Campaign
title: データモデルのベストプラクティス
description: キャンペーンデータモデル拡張のベストプラクティスを学ぶ
translation-type: tm+mt
source-git-commit: 8dd7b5a99a0cda0e0c4850d14a6cb95253715803
workflow-type: tm+mt
source-wordcount: '2713'
ht-degree: 4%

---

# データモデルのベストプラクティス{#data-model-best-practices}

このドキュメントでは、Adobe Campaignデータモデルを設計する際の主な推奨事項の概要を説明します。

Adobe Campaignシステムは非常に柔軟性が高く、最初の実装以外にも拡張できます。 ただし、可能性は無限ですが、賢明な判断を下し、開始がデータモデルを設計するための強力な基盤を構築することは非常に重要です。

キャンペーンの組み込みテーブルとそのやり取りについての詳細は、[このセクション](datamodel.md)を参照してください。

:bulb:キャンペーンスキーマを使い始めるには、[このセクション](schemas.md)を読んでください。

:bulb:[このページ](extend-schema.md)のAdobe Campaignデータベースの概念的データモデルを拡張するための拡張スキーマの設定方法を説明します。

## データモデルアーキテクチャ{#data-model-architecture}

Adobe Campaignは、オンラインとオフラインの戦略を調整して、パーソナライズされた顧客体験を作り出すのに役立つ、強力なクロスチャネルキャンペーン管理システムです。

### 顧客中心アプローチ{#customer-centric-approach}

ほとんどの電子メールサービスプロバイダーはリスト中心アプローチを使用してお客様と通信していますが、Adobe Campaignは、お客様とその属性の幅広い表示を活用するために、リレーショナルデータベースに依存しています。

各テーブルの説明にアクセスするには、**[!UICONTROL 管理者/設定/データスキーマ]**&#x200B;に移動し、リストからリソースを選択して、「**[!UICONTROL ドキュメント]**」タブをクリックします。


>[!NOTE]
>
>Adobe Campaignは、[カスタム受信者テーブル](custom-recipient.md)を作成できます。 ただし、ほとんどの場合、組み込みの[受信者テーブル](datamodel.md#ootb-profiles)を利用することをお勧めします。このテーブルには、既に組み込みのテーブルや機能が用意されています。

### Adobe Campaign{#data-for-campaign}のデータ

Adobe Campaignに送信するデータ マーケティングアクティビティに必要なデータを決定することが重要です。

>[!NOTE]
>
>Adobe Campaignは、データウェアハウスでもレポートツールでもありません。 したがって、可能な顧客とその関連情報をすべてAdobe Campaignにインポートしたり、レポートの作成にのみ使用されるデータをインポートしたりしないでください。

属性をAdobe Campaignに必要とするかどうかを判断するには、次のカテゴリのいずれかに該当するかどうか自問してください。

* **セグメント化**&#x200B;に使用する属性
* **データ管理プロセス**&#x200B;に使用される属性(集計の計算例)
* **パーソナライゼーション**&#x200B;に使用する属性

これらのいずれかに該当しない場合、Adobe Campaignでこの属性は必要ないと思われます。

### データ型の選択{#data-types}

システムのアーキテクチャとパフォーマンスを確実に保つには、次のベストプラクティスに従ってAdobe Campaignでデータを設定します。

* 大きなテーブルには、数値フィールドが含まれ、参照テーブルへのリンクが含まれていることがよくあります(値のリストを使用する場合)。
* **expr**&#x200B;属性を使用すると、スキーマ属性を、テーブル内の物理的な設定値ではなく、計算済みのフィールドとして定義できます。 これにより、両方の値を格納する必要なく、異なる形式（年齢や生年月日など）で情報にアクセスできます。 これは、フィールドの重複を避けるための良い方法です。 例えば、受信者テーブルでドメインの式が使用されますが、ドメインは電子メールフィールドに既に存在します。
* ただし、式の計算が複雑な場合は、**expr**&#x200B;属性を使用しないでください。この場合、即時に計算すると、クエリのパフォーマンスに影響を与える可能性があります。
* **XML**&#x200B;型は、作成するフィールドの数が多すぎるのを防ぐのに適しています。 ただし、データベース内でCLOB列を使用するので、ディスク領域も使用されます。 また、複雑なSQLクエリを引き起こし、パフォーマンスに影響を与える可能性もあります。
* **文字列**&#x200B;フィールドの長さは、常に列で定義する必要があります。 デフォルトでは、Adobe Campaignの最大長は255ですが、サイズが短くならないことが既にわかっている場合は、Adobeでフィールドの長さを短くすることをお勧めします。
* ソース・システムのサイズが過大評価されていて、サイズに達しないことが確実な場合は、ソース・システムのAdobe Campaignよりもフィールドの方が短い場合でも構いません。 Adobe Campaignが短い文字列か、それより小さい整数を意味する場合があります。

### フィールドの選択{#choice-of-fields}

ターゲット設定またはパーソナライゼーションの目的を持つフィールドは、テーブルに格納する必要があります。 つまり、パーソナライズされた電子メールの送信にフィールドを使用しない場合や、クエリの基準として使用する場合は、ディスク領域を使用しますが、使用できません。

ハイブリッドインスタンスおよびオンプレミスインスタンスの場合、FDA(Federated Data Access、外部データへのアクセスを可能にするオプション機能)は、キャンペーンプロセス中にフィールドをその場で追加する必要性をカバーします。 FDAがある場合は、すべてを読み込む必要はありません。 詳しくは、[Federated Data Access](../connect/fda.md)を参照してください。

### キーの選択{#choice-of-keys}

ほとんどのテーブルでデフォルトで定義されている&#x200B;**autouuid**&#x200B;に加えて、論理キーやビジネスキー（アカウント番号、クライアント番号など）を追加することを検討してください。 後でインポート/調整またはデータパッケージに使用できます。 詳しくは、[識別子](#identifiers)を参照してください。

パフォーマンスを高めるには、効率的なキーが不可欠です。 数値データ型は、テーブルのキーとして常に推奨されます。

<!-- ### Dedicated tablespaces {#dedicated-tablespaces}

The tablespace attribute in the schema allows you to specify a dedicated tablespace for a table.

The installation wizard allows you to store objects by type (data, temporary).

Dedicated tablespaces are better for partitioning, security rules, and allow fluid and flexible administration, better optimization, and performance. -->

## 識別子{#identifiers}

Adobe Campaignリソースには3つの識別子があり、別の識別子を追加できます。

次の表に、これらの識別子とその目的を示します。

| 識別子 | 説明 | ベストプラクティス |
|--- |--- |--- |
| ID | <ul><li>IDは、Adobe Campaignテーブルの物理的な主キーです。 組み込みテーブルの場合、UUID(Universally Unique ID)です</li><li>この識別子は一意である必要があります。 </li><li>UUIDは、スキーマ定義で表示できます。</li></ul> | <ul><li>自動生成された識別子は、ワークフローやパッケージ定義で参照として使用しないでください。</li><li>テーブルのIDはUUIDで、この型は変更しないでください。</li></ul> |
| 名前（または内部名） | <ul><li>この情報は、テーブル内のレコードの一意の識別子です。 この値は手動で更新でき、通常は生成された名前を付けます。</li><li>このIDは、別のAdobe Campaignインスタンスにデプロイする場合に値を保持するので、空にすることはできません。</li></ul> | <ul><li>オブジェクトをAdobe Campaignから別の環境にデプロイする場合、で生成されるレコード名を変更します。</li><li>オブジェクトに名前空間属性(*スキーマ*&#x200B;など)がある場合、この共通名前空間は、作成されたすべてのカスタムオブジェクトで使用されます。 一部の予約済み名前空間は使用しないでください。*nms*, *xtk*.</li><li>オブジェクトに名前空間（*workflow*&#x200B;や&#x200B;*workflow*&#x200B;など）がない場合、この名前空間概念は内部名オブジェクトのプレフィックスとして追加されます。*namespaceMyObjectName*.</li><li>スペース&quot;&quot;、セミコラム&quot;:&quot;、ハイフン&quot;-&quot;などの特殊文字は使用しないでください。 これらの文字はすべて、アンダースコア「_」に置き換えられます（許可されている文字）。 例えば、&quot;abc-def&quot;と&quot;abc:def&quot;は&quot;abc_def&quot;として保存され、互いに上書きされます。</li></ul> |
| ラベル | <ul><li>ラベルは、Adobe Campaign内のオブジェクトまたはレコードのビジネス識別子です。</li><li>このオブジェクトでは、スペースと特殊文字を使用できます。</li><li>レコードの一意性を保証するものではありません。</li></ul> | <ul><li>オブジェクトのラベルの構造を決定することをお勧めします。</li><li>これは、Adobe Campaignユーザーのレコードまたはオブジェクトを識別するための、最も使いやすいソリューションです。</li></ul> |

Adobe Campaignの主キーは、すべての組み込みテーブルに対して自動生成されるUUIDで、カスタムテーブルに対しても同じです。

IDの数が無限にある場合でも、最適なパフォーマンスを確保するために、データベースのサイズに注意する必要があります。 問題を回避するには、インスタンスの削除設定を必ず調整してください。 詳しくは、[この節](#data-retention)を参照してください。


## カスタム内部キー{#custom-internal-keys}

プライマリキーは、Adobe Campaignで作成されるすべてのテーブルに必要です。

ほとんどの組織は、外部システムからレコードを読み込んでいます。 受信者テーブルの物理キーは「id」属性ですが、カスタムキーを特定することもできます。

このカスタムキーは、外部システムフィードAdobe Campaignの実際のレコードの主キーです。

カスタムテーブルを作成する場合は、次の2つのオプションがあります。
* 自動生成されたキー(id)と内部キー（カスタム）の組み合わせ。 このオプションは、システムキーが複合キーである場合や整数でない場合に興味深いものです。 整数は、大きいテーブルで高いパフォーマンスを提供し、他のテーブルと結合します。
* 外部システムの主キーとして主キーを使用する。 異なるシステム間で一貫したキーを持つデータのインポートとエクスポートのアプローチを簡素化するので、通常、このソリューションをお勧めします。 キーの名前が「id」で、（自動生成ではなく）外部の値が入力されると想定される場合は、autouuidを無効にする必要があります。

>[!CAUTION]
>
>autouuidは、ワークフローで参照として使用しないでください。


## リンクと基数{#links-and-cardinality}

### リンク {#links}

大きなテーブルでは、「独自の」整合性に注意してください。 ワイドテーブルを持つレコードを「独自の」整合性で削除すると、インスタンスが停止する場合があります。 テーブルはロックされ、削除は1つずつ行われます。 したがって、大量の子テーブルには「中立」の整合性を使用することをお勧めします。

リンクを外部結合として宣言するのは、パフォーマンスには適していません。 ゼロIDレコードは外部結合機能をエミュレートします。 リンクでautouuidが使用されている場合は、外部結合を宣言する必要はありません。

ワークフロー内の任意のテーブルを結合できますが、Adobeでは、リソース間の共通リンクをデータ構造の定義に直接定義することをお勧めします。

リンクは、テーブル内の実際のデータと整列して定義する必要があります。 誤った定義は、予期せぬレコードの複製など、リンクを介して取得したデータに影響を与える可能性があります。

リンクには、テーブル名と同じ名前を付けます。リンク名は、遠隔テーブルの内容を理解するのに役立ちます。

「id」をサフィックスとして含むリンクの名前を付けないでください。 例えば、「transactionId」ではなく「transaction」という名前を付けます。

デフォルトでは、Adobe Campaignは外部テーブルの主キーを使用してリンクを作成します。 より明確にするために、リンク定義で結合を明示的に定義することをお勧めします。

### カーディナリティ {#cardinality}

リンクを設計する場合は、1-1関係が宣言されているときに、ターゲットレコードが一意であることを確認します。 そうしないと、1つしか期待できない場合に、結合が複数のレコードを返す可能性があります。 これにより、「クエリが予想以上の行を返した」場合に、配信の準備中にエラーが発生します。 リンク名をターゲットスキーマと同じ名前に設定します。

(1)側のスキーマにカーディナリティ(1 ～ N)のリンクを定義します。 例えば、関係受信者(1) - (N)トランザクションは、トランザクションスキーマ内で定義する必要があります。

デフォルトでは、リンクのカーディナリティが逆に(N)なので注意してください。 リンク定義にrevCardinality=&#39;single&#39;という属性を追加することで、リンク(1 ～ 1)を定義できます。

リバースリンクがユーザに表示されない場合は、リンク定義revLink=&#39;_NONE_&#39;を使用して非表示にできます。 例えば、受信者から最後に完了したトランザクションへのリンクを定義するのが適切な使用例です。 受信者から最後のトランザクションへのリンクのみが表示され、トランザクションテーブルに逆リンクを表示する必要はありません。

外部結合(1 ～ 0 ～ 1)を実行するリンクは、システムのパフォーマンスに影響を与えるので、注意して使用する必要があります。

## データリテンション {#data-retention}

Adobe Campaignは、データウェアハウスでもレポートツールでもありません。 したがって、Adobe Campaign・ソリューションのパフォーマンスを向上させるためには、データベースの増大を抑制する必要があります。 これを達成するには、以下のベストプラクティスに従うと役立ちます。

Campaign の組み込みログテーブルには保持期間がプリセットされており、通常はデータ保存期間が 6 か月以内に制限されています。

組み込みテーブルのデフォルトの保持期間は以下のとおりです。リテンションは実装時にアドビの技術管理者が設定します。値は顧客の要件に基づくため、実装ごとに異なる場合があります。

* **統合されたトラッキング**：1 年
* **配信ログ**：6 ヶ月
* **トラッキングログ**：1 年
* **削除された配信**：1 週間
* **却下をインポート**：6 か月
* **訪問者プロファイル**：1 か月
* **オファーの提案**：1 年
* **イベント**：1 ヶ月
* **イベント処理の統計**：1 か月
* **アーカイブしたイベント**：1 年
* **無視されたパイプラインイベント**：1 か月

>[!CAUTION]
>
>カスタムテーブルは、標準のクリーンアップ処理で削除されません。 この処理は1日目には必要ない場合がありますが、パフォーマンス上の問題を引き起こす可能性があるので、カスタム表のパージ処理を作成することを忘れないでください。

Adobe Campaign内のレコードの必要性を最小限に抑えるには、いくつかのソリューションがあります。
* Adobe Campaign以外のData Warehouseでデータをエクスポートします。
* マーケティングの慣行に従う一方で、使用するスペースを少なくする集約値を生成します。 例えば、最後の購入を追跡するために、Adobe Campaign内の完全な顧客取引履歴は必要ありません。

「deleteStatus」属性はスキーマで宣言できます。 レコードを削除済みとマークしてから、クリーンアップタスクで削除を延期する方が効率的です。

:speech_balloon:管理対象Cloud Servicesユーザーは、Adobeコンサルタントまたは技術管理者に連絡して、保存に関する詳細や、カスタム表に保存期間を設定する必要がある場合に、その詳細を知ってもらいます。

## パフォーマンス {#performance}

パフォーマンスを常に向上させるには、次のベストプラクティスに従ってください。

### 一般的な推奨事項 {#general-recommendations}

* クエリで「CONTAINS」などの操作を使用しないでください。 何を求められ、フィルターを適用するかがわかっている場合は、同じ条件を「EQUAL TO」または他の特定のフィルター演算子と共に適用します。
* インポートやエクスポートなどのプロセスが業務時間外に発生することを確認してください。
* すべての日別アクティビティのスケジュールがあることを確認し、スケジュールに従います。
* 毎日のプロセスの1つまたは数が失敗し、その同じ日に実行する必要がある場合は、手動プロセスを開始する際に、システムのパフォーマンスに影響を与える可能性があるので、競合するプロセスが実行されていないことを確認します。
* 読み込みプロセス中、または手動プロセスが実行されたときに、毎日のキャンペーンが実行されないことを確認します。
* すべての行にフィールドを複製する代わりに、1つまたは複数の参照テーブルを使用します。 キーと値のペアを使用する場合は、数値キーを選択することをお勧めします。
* 短い文字列は引き続き使用できます。 参照テーブルが外部システムに既に配置されている場合、それを再利用すると、Adobe Campaignとのデータ統合が容易になります。

### 1対多の関係{#one-to-many-relationships}

* データデザインはユーザビリティと機能に影響を与えます。 多数の1対多の関係を持つデータモデルを設計する場合、ユーザーがアプリケーション内で意味のあるロジックを作成するのが難しくなります。 1対多のフィルターロジックは、技術的でないマーケターが正しく構築し理解するのが困難な場合があります。
* 重要なフィールドはすべて1つのテーブルにまとめておくと、クエリの作成が容易になるので便利です。 結合を避けることができる場合に、テーブルをまたいでいくつかのフィールドを重複するのにパフォーマンスが良いこともあります。
* 特定の組み込み機能は、1対多の関係(オファーの重み付けの数式や配信など)を参照できません。

## 大きいテーブル{#large-tables}

Adobe Campaignは、サードパーティのデータベースエンジンに依存しています。 プロバイダーによっては、大きいテーブルに対するパフォーマンスを最適化するために、特定のデザインが必要になる場合があります。

大きなテーブルと複雑な結合を使用してデータモデルを設計する際に従う必要がある、いくつかの一般的なベストプラクティスを以下に示します。

* 追加のカスタム受信者テーブルを使用する場合は、各配信マッピングに対して専用のログテーブルがあることを確認してください。
* 特に未使用の列を識別して、列の数を減らします。
* 複数の条件や複数の列に対する結合など、複雑な結合を避けて、データモデルのリレーションを最適化します。
* 結合キーには、文字列ではなく常に数値データを使用します。
* ログ保持の深さをできる限り減らします。 より深い履歴が必要な場合は、集計の計算やカスタムログテーブルの処理を行って、より大きな履歴を保存できます。

### テーブルのサイズ{#size-of-tables}

テーブルサイズは、レコード数とレコードあたりの列数の組み合わせです。 両方とも、クエリのパフォーマンスに影響を与える可能性があります。

* **小さいサイズの**&#x200B;テーブルは、配信テーブルに似ています。
* **中サイズ**&#x200B;テーブルは、受信者テーブルと同じサイズです。 顧客1人につき1件のレコードがあります。
* **大きいサイズの**テーブルは、部分一致ログテーブルに似ています。 1人の顧客につき多くのレコードがあります。
例えば、データベースに1000万個の受信者が含まれる場合、部分一致ログテーブルには約1億～2億個のメッセージが格納され、配信テーブルには数千件のレコードが格納されます。

行数はパフォーマンスにも影響します。 Adobe Campaignデータベースは、ターゲット設定やパーソナライゼーションの目的で積極的に使用されない履歴データを格納するように設計されていません。これは、運用データベースです。

行数が多くなることに伴うパフォーマンス上の問題を防ぐには、必要なレコードのみをデータベースに保存します。 その他のレコードは、サードパーティのData Warehouseにエクスポートし、Adobe Campaignの運用データベースから削除する必要があります。

テーブルのサイズに関するベストプラクティスのいくつかを次に示します。

* フィールド数が少なく、数値データが多い大きなテーブルをデザインします。
* ブール値のような小さな数値を格納する場合は、大きな数値型の列を使用しないでください。
* 使用されていない列をテーブル定義から削除します。
* 履歴データや非アクティブなデータをAdobe Campaignデータベースに保持しない（書き出しとクリーンアップ）。
