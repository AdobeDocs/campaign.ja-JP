---
product: campaign
title: データ読み込み（ファイル）
description: データ読み込み（ファイル）ワークフローアクティビティの詳細を説明します
feature: Workflows, Data Management Activity
source-git-commit: 2b1dec4b9c456df4dfcebfe10d18e0ab01599275
workflow-type: tm+mt
source-wordcount: '1153'
ht-degree: 100%

---

# データ読み込み (ファイル){#data-loading-file}



## 用途 {#use}

**[!UICONTROL データ読み込み (ファイル)]** アクティビティを使用して、外部データのソースに直接アクセスし、読み込んだファイルを Adobe Campaign.で使用することができます。実際、ターゲティングオペレーションに必要なデータがすべて Adobe Campaign データベースにあるとは限りません。その場合には、外部のファイルを利用できます。

読み込むファイルはトランジションで指定できますが、このアクティビティの実行によって自動生成することもできます。例えば、クライアントのお気に入りの 10 個の製品リストがあり、それらの購入が外部のデータベースで管理されていたとします。

このアクティビティの設定ウィンドウの上部で、ファイルのフォーマットを定義できます。そのためには、インポートするファイルと同じフォーマットのサンプルファイルを使用します。このファイルは、ローカルマシンまたはサーバーのどちらにも保存できます。

>[!CAUTION]
>
>サポートされるファイルは、「フラット」な構造のファイル（CSV、TXT など）のみです。XML フォーマットのファイルは推奨されません。

![](assets/s_advuser_wf_etl_file.png)

ファイルのインポート中にプリプロセスを実行するように設定できます。例えば、サーバー上でファイルを解凍せずに（これによりファイルの解凍スペースが節約される）、ファイル処理にファイルの解凍を含めることができます。「**[!UICONTROL ファイルを前処理]**」オプションを選択し、「**[!UICONTROL なし]**」、「**[!UICONTROL 解凍]**（zcat）」または「**[!UICONTROL 復号化]**（gpg）」の 3 つのオプションから選択します。

![](assets/preprocessing-dataloading.png)

詳細については、次のセクションを参照してください。

## ファイルフォーマットの定義 {#defining-the-file-format}

ファイルを読み込む際に、列のフォーマットが各データタイプのデフォルトのパラメーターに照らして自動的に検出されます。このデフォルトのパラメーターを編集して（特に誤りや空の値がある場合）、特定の処理を指定してデータに適用することができます。

それには、「**[!UICONTROL データ読み込み (ファイル)]**」アクティビティのメインウィンドウで「**[!UICONTROL ファイルフォーマットを変更するには、ここをクリック...]**」を選択します。フォーマット詳細ウィンドウが表示されます。

![](assets/file_loading_columns_format.png)

ファイルの全般的なフォーマットと各列のフォーマットを編集できます。

ファイルの全般的なフォーマットでは、列を認識する方法（エンコーディング、使用する区切り文字など）を定義できます。

列のフォーマットでは、以下の設定で各列の値の処理方法を定義できます。

* **[!UICONTROL 列を無視]**：ファイルの読み込み時の処理で、この列をスキップします。
* **[!UICONTROL データタイプ]**：各列に適用されるデータタイプを指定します。
* **[!UICONTROL NULL を許可]**：空の値の処理方法を指定します。

   * **[!UICONTROL Adobe Campaign のデフォルト値]**：数値フィールドのみエラーを生成します。それ以外は、null 値を挿入します。
   * **[!UICONTROL 空の値を許可]**：空の値を許可します。したがって、null 値が挿入されます。
   * **[!UICONTROL 常に反映]**：値が空の場合に、エラーを生成します。

* **[!UICONTROL 長さ]**：**文字列**&#x200B;タイプのデータの最大文字数を指定します。
* **[!UICONTROL フォーマット]**：日付と時間のフォーマットを定義します。
* **[!UICONTROL データ変換]**：大文字と小文字の区別を&#x200B;**文字列**&#x200B;に適用するかどうかを定義します。

   * **[!UICONTROL なし]**：読み込んだ文字列を変更しません。
   * **[!UICONTROL 最初の文字は大文字]**：文字列の各単語の最初の文字を大文字にします。
   * **[!UICONTROL 大文字]**：文字列のすべての文字列を大文字にします。
   * **[!UICONTROL 小文字]**：文字列のすべての文字列を小文字にします。

* **[!UICONTROL スペースの処理]**：文字列内の特定の空白文字を無視するかどうかを指定します。**[!UICONTROL スペースを無視]**：文字列の前後の空白文字のみを無視します。
* **[!UICONTROL エラー処理]**：エラーが発生した場合の処理を定義します。

   * **[!UICONTROL 値を無視]**：値を無視します。ワークフローの実行ログに警告が生成されます。
   * **[!UICONTROL ラインを却下]**：すべての行に対して処理をおこないません。
   * **[!UICONTROL エラーの場合はデフォルト値を使用]**：エラーの原因となった値を「**[!UICONTROL デフォルト値]**」フィールドで定義されたデフォルトの値と入れ替えます。
   * **[!UICONTROL 再マッピングの値がない場合はラインを却下]**：マッピングのエラー値が定義されている場合を除き、すべての行に対して処理をおこないません（「**[!UICONTROL マッピング]**」オプションについては以下を参照）。
   * **[!UICONTROL 値が再マッピングされない場合はデフォルト値を使用]**：マッピングのエラー値が定義されている場合を除き、エラーの原因となった値を「**[!UICONTROL デフォルト値]**」フィールドで定義されたデフォルトの値と入れ替えます（「**[!UICONTROL マッピング]**」オプションについては以下を参照）。

* **[!UICONTROL デフォルト値]**：選択したエラーの処理方法に応じてデフォルトの値を選択します。
* **[!UICONTROL マッピング]**：このフィールドは列の詳細設定の場合のみ表示されます（ダブルクリックまたは列リストの右側のオプションを選択してアクセスした場合）。これにより、特定の値を読み込んだときに、その値を変換します。例えば、「three」を「3」に変換できます。

## 例：データの収集とデータベースへの読み込み {#example--collecting-data-and-loading-it-in-the-database}

以下の例では、サーバー上のファイルを毎日取得し、コンテンツを読み込み、そのコンテンツの情報に基づいてデータベース内のデータを更新することができます。取得するファイルには、購入をおこなった顧客（3,000 ユーロ以上または未満）、購入の返金をおこなった顧客、または店舗を訪れただけで何も購入しなかった顧客に関する情報が含まれています。この情報に基づいて、様々な処理がデータベースの顧客プロファイルに適用されます。

![](assets/s_advuser_load_file_sample_0.png)

1. ファイルコレクターを使用すれば、ディレクトリに格納されていたファイルを、所定の日時に定期的に取得できます。

   「**[!UICONTROL ディレクトリ]**」タブには、取得するファイルに関する情報が表示されます。この例では、サーバーの tmp/Adobe/Data/files ディレクトリに格納されている、「customers」という単語をファイル名含むテキストファイルが取得されます。

   **[!UICONTROL ファイルコレクター]**&#x200B;の使用方法について詳しくは、[ファイルコレクター](file-collector.md)の節を参照してください。

   ![](assets/s_advuser_load_file_sample_1.png)

   「**[!UICONTROL スケジュール]**」タブで、コレクターの実行スケジュールを計画できます。例えば、これらのファイルの有無を定期的に確認するスケジュールを作成できます。

   ここでは、各営業日の午後 9 時にコレクターが実行されるようにします。

   ![](assets/s_advuser_load_file_sample_2.png)

   それには、編集ツールの右下にある「**[!UICONTROL 変更...]**」ボタンをクリックして、スケジュールを設定します。

   詳しくは、[スケジューラー](scheduler.md)を参照してください。

1. 次に、「データ読み込み (ファイル)」アクティビティを設定して、取得したファイルを読み込む方法を指定できます。それには、読み込むファイルと同じ構造を持つサンプルファイルを選択します。

   ![](assets/s_advuser_load_file_sample_3.png)

   ここでは、ファイルに 5 つの列があります。

   * 1 番目の列には、購入（3,000 ユーロ以上または未満）、未購入または 1 つ以上の購入アイテムの返金というイベントと紐付けするコードが含まれています。
   * 2 番目から 4 番目の列はそれぞれ、クライアントの姓、名前、E メールおよびアカウント番号が含まれます。

   世も混まれるファイルのフォーマット設定は、Adobe Campaign へのデータインポート時に定義されたフォーマット設定と紐付けされます。詳しくは、こちらを参照してください。

1. 分割アクティビティで、「**イベント**」列の値に従って、作成するサブセットを指定します。

   分割アクティビティについて詳しくは、この節で説明しています。

   ![](assets/s_advuser_load_file_sample_4.png)

   各サブセットについて、「**イベント**」列にいずれかの値を指定します。

   ![](assets/s_advuser_load_file_sample_5.png)

   「**[!UICONTROL 分割]**」アクティビティには次の情報が含まれます。

   ![](assets/s_advuser_load_file_sample_6.png)

1. 次に、母集団の各タイプについて、実行されるプロセスを指定します。この例では、データベースの「**[!UICONTROL データを更新]**」を指定します。それには、「**[!UICONTROL データを更新]**」アクティビティを、分割アクティビティからの各アウトバウンドトランジションの最後に配置します。

   「**[!UICONTROL データを更新]**」アクティビティについて詳しくは、[データ更新](update-data.md)の節で説明しています。
